{
  "$schema": "https://tree-sitter.github.io/tree-sitter/assets/schemas/grammar.schema.json",
  "name": "hledger",
  "rules": {
    "source_file": {
      "type": "REPEAT",
      "content": {
        "type": "CHOICE",
        "members": [
          {
            "type": "SYMBOL",
            "name": "journal_item"
          },
          {
            "type": "STRING",
            "value": "\n"
          }
        ]
      }
    },
    "journal_item": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SYMBOL",
          "name": "transaction"
        },
        {
          "type": "SYMBOL",
          "name": "directive"
        }
      ]
    },
    "transaction": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SYMBOL",
          "name": "transaction_plain"
        }
      ]
    },
    "transaction_plain": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "date"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "whitespace"
                },
                {
                  "type": "SYMBOL",
                  "name": "status"
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "whitespace"
                },
                {
                  "type": "SYMBOL",
                  "name": "code"
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "whitespace"
                },
                {
                  "type": "SYMBOL",
                  "name": "description"
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "whitespace"
                },
                {
                  "type": "SYMBOL",
                  "name": "inline_comment"
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "\n"
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "posting"
              },
              {
                "type": "SEQ",
                "members": [
                  {
                    "type": "SYMBOL",
                    "name": "whitespace"
                  },
                  {
                    "type": "SYMBOL",
                    "name": "inline_comment"
                  },
                  {
                    "type": "STRING",
                    "value": "\n"
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "date": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "_date"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "secondary_date"
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "secondary_date": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "="
        },
        {
          "type": "SYMBOL",
          "name": "_date"
        }
      ]
    },
    "_4d": {
      "type": "PATTERN",
      "value": "\\d{4}"
    },
    "_2d": {
      "type": "PATTERN",
      "value": "\\d{2}"
    },
    "_date_separator": {
      "type": "CHOICE",
      "members": [
        {
          "type": "STRING",
          "value": "-"
        },
        {
          "type": "STRING",
          "value": "."
        },
        {
          "type": "STRING",
          "value": "/"
        }
      ]
    },
    "_date": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SEQ",
          "members": [
            {
              "type": "SYMBOL",
              "name": "_4d"
            },
            {
              "type": "SYMBOL",
              "name": "_date_separator"
            },
            {
              "type": "SYMBOL",
              "name": "_2d"
            },
            {
              "type": "SYMBOL",
              "name": "_date_separator"
            },
            {
              "type": "SYMBOL",
              "name": "_2d"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "SYMBOL",
              "name": "_2d"
            },
            {
              "type": "SYMBOL",
              "name": "_date_separator"
            },
            {
              "type": "SYMBOL",
              "name": "_2d"
            }
          ]
        }
      ]
    },
    "status": {
      "type": "CHOICE",
      "members": [
        {
          "type": "STRING",
          "value": "*"
        },
        {
          "type": "STRING",
          "value": "!"
        }
      ]
    },
    "code": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "("
        },
        {
          "type": "PATTERN",
          "value": "[^)]*"
        },
        {
          "type": "STRING",
          "value": ")"
        }
      ]
    },
    "description": {
      "type": "PATTERN",
      "value": "[^*!\\(;\\n][^\\s;\\n]*( [^\\s;\\n]+)*"
    },
    "posting": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "whitespace"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "status"
                },
                {
                  "type": "SYMBOL",
                  "name": "whitespace"
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "SYMBOL",
          "name": "account"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "SEQ",
                  "members": [
                    {
                      "type": "SYMBOL",
                      "name": "whitespace"
                    },
                    {
                      "type": "SYMBOL",
                      "name": "balance_assignment"
                    }
                  ]
                },
                {
                  "type": "SEQ",
                  "members": [
                    {
                      "type": "SYMBOL",
                      "name": "whitespace"
                    },
                    {
                      "type": "SYMBOL",
                      "name": "amount"
                    },
                    {
                      "type": "CHOICE",
                      "members": [
                        {
                          "type": "SEQ",
                          "members": [
                            {
                              "type": "SYMBOL",
                              "name": "whitespace"
                            },
                            {
                              "type": "CHOICE",
                              "members": [
                                {
                                  "type": "SYMBOL",
                                  "name": "price"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "cost"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "BLANK"
                        }
                      ]
                    },
                    {
                      "type": "CHOICE",
                      "members": [
                        {
                          "type": "SEQ",
                          "members": [
                            {
                              "type": "SYMBOL",
                              "name": "whitespace"
                            },
                            {
                              "type": "CHOICE",
                              "members": [
                                {
                                  "type": "SYMBOL",
                                  "name": "balance_assertion"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "balance_assertion_subaccount_inclusive"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "balance_assertion_sole_commodity"
                                },
                                {
                                  "type": "SYMBOL",
                                  "name": "balance_assertion_subaccount_inclusive_sole_commodity"
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "BLANK"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "whitespace"
                },
                {
                  "type": "SYMBOL",
                  "name": "inline_comment"
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "\n"
        }
      ]
    },
    "account": {
      "type": "PATTERN",
      "value": "[^ ;\\n](\\S \\S \\S|\\S \\S|\\S)*"
    },
    "balance_assignment": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "="
        },
        {
          "type": "SYMBOL",
          "name": "whitespace"
        },
        {
          "type": "SYMBOL",
          "name": "amount"
        }
      ]
    },
    "price": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "@"
        },
        {
          "type": "SYMBOL",
          "name": "whitespace"
        },
        {
          "type": "SYMBOL",
          "name": "amount"
        }
      ]
    },
    "cost": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "@@"
        },
        {
          "type": "SYMBOL",
          "name": "whitespace"
        },
        {
          "type": "SYMBOL",
          "name": "amount"
        }
      ]
    },
    "balance_assertion": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "="
        },
        {
          "type": "SYMBOL",
          "name": "whitespace"
        },
        {
          "type": "SYMBOL",
          "name": "amount"
        }
      ]
    },
    "balance_assertion_subaccount_inclusive": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "=*"
        },
        {
          "type": "SYMBOL",
          "name": "whitespace"
        },
        {
          "type": "SYMBOL",
          "name": "amount"
        }
      ]
    },
    "balance_assertion_sole_commodity": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "=="
        },
        {
          "type": "SYMBOL",
          "name": "whitespace"
        },
        {
          "type": "SYMBOL",
          "name": "amount"
        }
      ]
    },
    "balance_assertion_subaccount_inclusive_sole_commodity": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "==*"
        },
        {
          "type": "SYMBOL",
          "name": "whitespace"
        },
        {
          "type": "SYMBOL",
          "name": "amount"
        }
      ]
    },
    "amount": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SEQ",
          "members": [
            {
              "type": "SYMBOL",
              "name": "quantity"
            },
            {
              "type": "SYMBOL",
              "name": "whitespace"
            },
            {
              "type": "SYMBOL",
              "name": "commodity"
            }
          ]
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "SYMBOL",
              "name": "commodity"
            },
            {
              "type": "SYMBOL",
              "name": "whitespace"
            },
            {
              "type": "SYMBOL",
              "name": "quantity"
            }
          ]
        }
      ]
    },
    "quantity": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "STRING",
                  "value": "+"
                },
                {
                  "type": "STRING",
                  "value": "-"
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "PATTERN",
          "value": "\\d+([ .,]\\d+)*"
        }
      ]
    },
    "commodity": {
      "type": "CHOICE",
      "members": [
        {
          "type": "PATTERN",
          "value": "\\p{L}+",
          "flags": "u"
        },
        {
          "type": "PATTERN",
          "value": "\\p{Sc}",
          "flags": "u"
        },
        {
          "type": "PATTERN",
          "value": "\"[^\"\\n]*\""
        }
      ]
    },
    "directive": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SYMBOL",
          "name": "directive_account"
        }
      ]
    },
    "directive_account": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "account"
        },
        {
          "type": "SYMBOL",
          "name": "whitespace"
        },
        {
          "type": "SYMBOL",
          "name": "account"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "whitespace"
                },
                {
                  "type": "SYMBOL",
                  "name": "inline_comment"
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "\n"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "REPEAT1",
              "content": {
                "type": "SEQ",
                "members": [
                  {
                    "type": "SYMBOL",
                    "name": "whitespace"
                  },
                  {
                    "type": "SYMBOL",
                    "name": "inline_comment"
                  },
                  {
                    "type": "STRING",
                    "value": "\n"
                  }
                ]
              }
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "comment": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": ";"
            },
            {
              "type": "STRING",
              "value": "#"
            },
            {
              "type": "STRING",
              "value": "*"
            }
          ]
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "CHOICE",
            "members": [
              {
                "type": "PATTERN",
                "value": "[^\\n]?"
              }
            ]
          }
        }
      ]
    },
    "inline_comment": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": ";"
        },
        {
          "type": "PATTERN",
          "value": "[^\\n]*"
        }
      ]
    },
    "whitespace": {
      "type": "REPEAT1",
      "content": {
        "type": "CHOICE",
        "members": [
          {
            "type": "STRING",
            "value": " "
          },
          {
            "type": "STRING",
            "value": "\t"
          }
        ]
      }
    }
  },
  "extras": [],
  "conflicts": [],
  "precedences": [],
  "externals": [],
  "inline": [
    "whitespace"
  ],
  "supertypes": [
    "journal_item",
    "transaction",
    "directive"
  ],
  "reserved": {}
}